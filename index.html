<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portalsbase — Status Page</title>
  <style>
    :root {
      --bg: #020617;
      --card: #0a1122;
      --muted: #9ca3af;
      --ok: #10b981;
      --error: #f97316; /* orange for errors/timeouts */
      --fail: #ef4444;  /* red for offline */
      --accent: #3b82f6;
      --glow: 0 0 20px rgba(59,130,246,0.6);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', ui-sans-serif, system-ui;
      background: radial-gradient(circle at top left, #0f172a 0%, #020617 80%);
      color: #e2e8f0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 2rem;
    }
    .wrap {
      width: 100%;
      max-width: 960px;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    header {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: rgba(255,255,255,0.03);
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      box-shadow: var(--glow);
    }
    h1 { margin: 0; font-size: 1.5rem; }
    p.lead { margin: 0; color: var(--muted); font-size: 0.95rem; }
    .card {
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 0 25px rgba(0,0,0,0.3);
      transition: transform 0.2s ease;
    }
    .card:hover {
      transform: translateY(-2px);
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 80px 120px 120px 100px;
      align-items: center;
      gap: 0.75rem;
    }
    .head { 
      color: var(--muted); 
      font-size: 0.8rem; 
      text-transform: uppercase; 
      letter-spacing: 0.5px; 
    }
    .dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #64748b;
      box-shadow: 0 0 10px rgba(255,255,255,0.1);
      transition: background 0.3s, box-shadow 0.3s;
    }
    .ok { background: var(--ok); box-shadow: 0 0 10px var(--ok); }
    .error { background: var(--error); box-shadow: 0 0 10px var(--error); }
    .down { background: var(--fail); box-shadow: 0 0 10px var(--fail); }
    .unknown { background: #6b7280; }
    .time { color: var(--muted); font-size: 0.9rem; }

    .status-text.ok { color: var(--ok); font-weight: 600; }
    .status-text.error { color: var(--error); font-weight: 600; }
    .status-text.down { color: var(--fail); font-weight: 600; }

    .btn-view {
      background: var(--accent);
      border: none;
      color: white;
      padding: 0.4rem 0.7rem;
      border-radius: 0.4rem;
      cursor: pointer;
      font-size: 0.85rem;
      transition: background 0.2s, transform 0.2s;
    }
    .btn-view:hover {
      background: #2563eb;
      transform: scale(1.05);
    }

    footer {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: var(--muted);
    }
    footer a { color: var(--accent); text-decoration: none; }
    footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="width:50px;height:50px;border-radius:12px;background:linear-gradient(180deg,var(--accent),#2563eb);display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;font-size:1.3rem;">A</div>
      <div>
        <h1>Portalsbase — Status Page</h1>
        <p class="lead">Automatically checks these domains every 5 seconds.</p>
      </div>
    </header>

    <section class="card">
      <div class="grid" style="margin-bottom:0.5rem;font-weight:700;">
        <div class="head">Service</div>
        <div class="head">Status</div>
        <div class="head">Last checked</div>
        <div class="head">Response</div>
        <div class="head">Action</div>
      </div>
      <div id="sites"></div>
    </section>
  </div>

<script>
(() => {
  const DEFAULT_SITES = [
    'portalsbase.com',
    'edutimely.portalsbase.com',
    'gps.portalsbase.com',
    'dev.portalsbase.com'
  ];

  const sitesContainer = document.getElementById('sites');
  const sites = DEFAULT_SITES.slice();

  function render() {
    sitesContainer.innerHTML = '';
    sites.forEach((host, idx) => {
      const row = document.createElement('div');
      row.className = 'grid';
      row.innerHTML = `
        <div style="font-weight:600">${host}</div>
        <div><div class="dot unknown" id="dot-${idx}"></div></div>
        <div><div class="time" id="time-${idx}">—</div></div>
        <div id="response-${idx}" class="time status-text">—</div>
        <div><button class="btn-view" onclick="window.open('https://${host}', '_blank')">View Page</button></div>
      `;
      sitesContainer.appendChild(row);
    });
  }

  function normalizeUrl(host) {
    if (!/^https?:\/\//i.test(host)) host = 'https://' + host;
    return host.replace(/\/$/,'') + '/favicon.ico';
  }

  function checkSite(i) {
    const host = sites[i];
    const url = normalizeUrl(host);
    const dot = document.getElementById('dot-' + i);
    const timeEl = document.getElementById('time-' + i);
    const respEl = document.getElementById('response-' + i);
    if (!dot || !timeEl) return;
    dot.className = 'dot unknown';
    timeEl.textContent = 'checking...';
    respEl.textContent = '—';
    respEl.className = 'time status-text';

    let handled = false;
    const img = new Image();
    const start = Date.now();
    let timeout = setTimeout(()=>{
      if (handled) return; handled = true;
      dot.className = 'dot error';
      timeEl.textContent = 'timeout';
      respEl.textContent = 'Error';
      respEl.classList.add('error');
    }, 10000);

    img.onload = () => {
      if (handled) return; handled = true; clearTimeout(timeout);
      dot.className = 'dot ok';
      const ms = Date.now() - start; timeEl.textContent = ms + ' ms';
      respEl.textContent = 'Online';
      respEl.classList.add('ok');
    };
    img.onerror = () => {
      if (handled) return;
      fetch(url, {method: 'HEAD'})
        .then(resp => {
          handled = true; clearTimeout(timeout);
          if (resp.ok) { 
            dot.className = 'dot ok'; 
            timeEl.textContent = (Date.now()-start)+' ms'; 
            respEl.textContent = 'Online'; 
            respEl.classList.add('ok');
          } else { 
            dot.className = 'dot error'; 
            timeEl.textContent = resp.status+' '+resp.statusText; 
            respEl.textContent = 'Error'; 
            respEl.classList.add('error');
          }
        })
        .catch(()=>{
          if (handled) return; handled = true; clearTimeout(timeout);
          dot.className = 'dot down';
          timeEl.textContent = 'offline';
          respEl.textContent = 'Offline';
          respEl.classList.add('down');
        });
    };
    img.src = url + '?_=' + Date.now();
  }

  function checkAll() {
    sites.forEach((s, i) => checkSite(i));
  }

  render();
  setTimeout(checkAll, 500);
  setInterval(checkAll, 5000);
})();
</script>
</body>
</html>
